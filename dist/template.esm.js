var markGenerator=function(t){return"\x3c!--"+t+"--\x3e"},escapePart=function(t){return t.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")},t=/\s(\S+)\=[\"\']([^\"]*)$/,e=/^([^\"]*)[\"|\'][\s|\>]/,acceptNode=function(t){var e=t.nodeType,r=t.nodeValue;return e===Node.COMMENT_NODE&&parseInt(r)?NodeFilter.FILTER_ACCEPT:NodeFilter.FILTER_REJECT},extendStatics=function(t,e){return(extendStatics=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(t,e)};var r={1:"injected functions cannot be inlined. Please define the function outside and reference it by its name. Ex.: <button onclick='${fn}'>",2:"requested slot is not found",3:"to render a template into a list, every list items must be a Template instance."},n=function(t){function TemplateError(e,r,n){void 0===r&&(r=-1);var o=t.call(this,e)||this;return o.name="TemplateError",o.message=e,o.code=r,o.metadata=n,o}return function __extends(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");function __(){this.constructor=t}extendStatics(t,e),t.prototype=null===e?Object.create(e):(__.prototype=e.prototype,new __)}(TemplateError,t),TemplateError.generate=function(t,e){return new TemplateError(r[t],t,e)},TemplateError.INLINE_FUNCTION=1,TemplateError.SLOT_NOT_FOUND=2,TemplateError.NOT_TEMPLATE_VALUE=3,TemplateError}(Error),o=function(){function Processor(t,e){this.template=t,this.container=e}return Processor.prototype.getSlot=function(t){for(var e,r=this.template.slots.length,o=0;o<r;o++){var i=this.template.slots[o];if(i.slotIndex===t)return i}throw e={template:this.template,slot:t},n.generate(n.SLOT_NOT_FOUND,e)},Processor.prototype.render=function(){var t=document.createNodeIterator(this.container,NodeFilter.SHOW_COMMENT,{acceptNode:acceptNode}),e=t.nextNode();if(null!==e)for(var r=0;e;){var n=parseInt(e.nodeValue);if(n>r)this.getSlot(n).commit(e),r=n;e=t.nextNode()}else this.container.appendChild(this.template.element)},Processor}(),i=function(){function Slot(t,e,r){this.slotIndex=t,this.attr=r,this.value=e}return Object.defineProperty(Slot.prototype,"isAttr",{get:function(){return null!==this.attr&&void 0!==this.attr},enumerable:!1,configurable:!0}),Slot.prototype.commit=function(t){if(this.isAttr)this.commitAttr(t.nextSibling);else{var e=this.value;if(Array.isArray(e)){for(var r=[],n=t.nextSibling;n.nodeType!==Node.COMMENT_NODE&&"-"!==n.nodeValue;)r.push(n),n=n.nextSibling;this.commitTemplates(r,t,n,e)}else{var o=t.nextSibling;"Template"===e.constructor.name?this.commitTemplate(o,t,e):this.commitValue(o,t,e)}}},Slot.prototype.commitAttr=function(t){var e=this.attr,r=Array.isArray(this.value)?this.value.join(" "):this.value;t.getAttribute(e)!==r&&t.setAttribute(e,r)},Slot.prototype.commitValue=function(t,e,r){null==t?e.parentNode.insertBefore(document.createTextNode(r),e.nextSibling):t.nodeValue!==r&&(t.nodeValue=r)},Slot.prototype.commitTemplate=function(t,e,r){void 0===t?e.parentNode.insertBefore(r.element,e.nextSibling):t.nodeType===Node.COMMENT_NODE?t.parentNode.insertBefore(r.element,t):r.match(t)?new o(r,t).render():t.parentNode.replaceChild(r.element,t)},Slot.prototype.commitTemplates=function(t,e,r,o){for(var i,s=o.length,a=t.length,l=s>a?s:a,p=0;p<l;p++){var u=[t[p],o[p]],c=u[0],h=u[1];if(void 0!==h){if("Template"!==h.constructor.name)throw i={node:c,template:h},n.generate(n.NOT_TEMPLATE_VALUE,i);this.commitTemplate(c||r,e,h)}else void 0!==c&&c.parentNode.removeChild(c)}},Slot}(),s=function(){function Template(t,e){void 0===e&&(e=[]),this.strings=t,this.slots=[],this.prepare(e)}return Object.defineProperty(Template.prototype,"regexp",{get:function(){for(var t="",e=this.strings.length-1,r=0;r<e;r++)t+=escapePart(this.strings[r])+"(.*)",this.slots[r].isAttr||(t+=escapePart(markGenerator("-")));return t+=escapePart(this.strings[e]),new RegExp(t)},enumerable:!1,configurable:!0}),Object.defineProperty(Template.prototype,"html",{get:function(){for(var t="",e=this.strings.length-1,r=0;r<e;r++){var n=this.slots[r];n.attr;var o=n.value;Array.isArray(o)&&(o=o.join("")),t+=this.strings[r]+o,this.slots[r].isAttr||(t+=markGenerator("-"))}return t+this.strings[e]},enumerable:!1,configurable:!0}),Object.defineProperty(Template.prototype,"element",{get:function(){return document.createRange().createContextualFragment(this.html)},enumerable:!1,configurable:!0}),Template.prototype.toString=function(){return this.html},Template.prototype.match=function(t){var e=t.outerHTML;return this.regexp.test(e)},Template.prototype.prepare=function(r){for(var o,s=0,a=this.strings.length-1,l=0;l<a;l++){var p=this.strings[l],u=r[l];if("function"==typeof u){var c=u.name;if(""===c)throw o={part:p,value:u},n.generate(n.INLINE_FUNCTION,o);u=c+"()"}var h=t.exec(p);if(null!==h){var m=p.lastIndexOf("<");if(-1!=m&&s++,0===m)this.strings[l]=markGenerator(s)+p;else if(m>0){var f=p.substring(0,m-1),g=p.substring(m);this.strings[l]=f+markGenerator(s)+g}var d=h[1],T=h[2],v=this.strings[l].length-T.length;this.strings[l]=this.strings[l].slice(0,v);for(var y="",N=this.strings[l+1],E=e.exec(N);null===E;)y+=N+r[l+1],this.strings.splice(l+1,1),r.splice(l+1,1),a--,N=this.strings[l+1],E=e.exec(N);var _=E[1];this.strings[l+1]=N.slice(_.length);var b=T+u+y+_;this.slots.push(new i(s,b,d))}else s++,this.strings[l]=p+markGenerator(s),this.slots.push(new i(s,u))}},Template}(),html=function(t){for(var e=[],r=1;r<arguments.length;r++)e[r-1]=arguments[r];return new s(t.raw.slice(0),e)},render=function(t,e){return new o(t,e).render()};export{s as Template,html,render};
