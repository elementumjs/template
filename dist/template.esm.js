var t=function(t){return"\x3c!--"+t+"--\x3e"},e=function(t){return t.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")},n=/\s(\S+)\=[\"\']([^\"]*)$/,r=/^([^\"]*)[\"|\'][\s|\>]/,i=function(t){var e=t.nodeType,n=t.nodeValue;return e===Node.COMMENT_NODE&&parseInt(n)?NodeFilter.FILTER_ACCEPT:NodeFilter.FILTER_REJECT},o=function(){function t(t,e){this.template=t,this.container=e}return t.prototype.getSlotByIndex=function(t){for(var e=this.template.slots.length,n=0;n<e;n++){var r=this.template.slots[n];if(r.slotIndex===t)return r}throw new Error("slot not found")},t.prototype.render=function(){var t=document.createNodeIterator(this.container,NodeFilter.SHOW_COMMENT,{acceptNode:i}),e=t.nextNode();if(null!==e)for(var n=0;e;){var r=parseInt(e.nodeValue);if(r>n)this.getSlotByIndex(r).commit(e),n=r;e=t.nextNode()}else this.container.appendChild(this.template.element)},t}(),s=function(){function t(t,e,n){this.slotIndex=t,this.attr=n,this.value=e}return Object.defineProperty(t.prototype,"isAttr",{get:function(){return null!==this.attr&&void 0!==this.attr},enumerable:!1,configurable:!0}),t.prototype.commit=function(t){if(this.isAttr)this.commitAttr(t.nextSibling);else{var e=this.value;if(Array.isArray(e)){for(var n=[],r=t.nextSibling;r.nodeType!==Node.COMMENT_NODE&&"-"!==r.nodeValue;)n.push(r),r=r.nextSibling;this.commitTemplates(n,t,r,e)}else{var i=t.nextSibling;"Template"===e.constructor.name?this.commitTemplate(i,t,e):this.commitValue(i,t,e)}}},t.prototype.commitAttr=function(t){var e=this.attr,n=Array.isArray(this.value)?this.value.join(" "):this.value;t.getAttribute(e)!==n&&t.setAttribute(e,n)},t.prototype.commitValue=function(t,e,n){null==t?e.parentNode.insertBefore(document.createTextNode(n),e.nextSibling):t.nodeValue!==n&&(t.nodeValue=n)},t.prototype.commitTemplate=function(t,e,n){void 0===t?e.parentNode.insertBefore(n.element,e.nextSibling):t.nodeType===Node.COMMENT_NODE?t.parentNode.insertBefore(n.element,t):n.match(t)?new o(n,t).render():t.parentNode.replaceChild(n.element,t)},t.prototype.commitTemplates=function(t,e,n,r){for(var i=r.length,o=t.length,s=i>o?i:o,a=0;a<s;a++){var l=[t[a],r[a]],u=l[0],c=l[1];if(void 0!==c){if("Template"!==c.constructor.name){throw new Error("to render a template into a list, every list items must be a Template instance.")}this.commitTemplate(u||n,e,c)}else void 0!==u&&u.parentNode.removeChild(u)}},t}(),a=function(){function i(t,e){void 0===e&&(e=[]),this.strings=t,this.slots=[],this.prepare(e)}return Object.defineProperty(i.prototype,"html",{get:function(){for(var e="",n=this.strings.length-1,r=0;r<n;r++){var i=this.slots[r];i.attr;var o=i.value;Array.isArray(o)&&(o=o.join("")),e+=this.strings[r]+o,this.slots[r].isAttr||(e+=t("-"))}return e+this.strings[n]},enumerable:!1,configurable:!0}),Object.defineProperty(i.prototype,"regexp",{get:function(){for(var n="",r=this.strings.length-1,i=0;i<r;i++)n+=e(this.strings[i])+"(.*)",this.slots[i].isAttr||(n+=e(t("-")));return n+=e(this.strings[r]),new RegExp(n)},enumerable:!1,configurable:!0}),Object.defineProperty(i.prototype,"element",{get:function(){return document.createRange().createContextualFragment(this.html)},enumerable:!1,configurable:!0}),i.prototype.toString=function(){return this.html},i.prototype.match=function(t){var e=t.outerHTML;return this.regexp.test(e)},i.prototype.prepare=function(e){for(var i=0,o=this.strings.length-1,a=0;a<o;a++){var l=this.strings[a],u=e[a];if("function"==typeof u){var c=u.name;if(""===c){throw new Error('injected functions cannot be inlined.Please define the function outside and reference it by its name. Ex.: <button onclick="${fn}">')}u=c+"()"}var h=n.exec(l);if(null!==h){var p=l.lastIndexOf("<");if(-1!=p&&i++,0===p)this.strings[a]=t(i)+l;else if(p>0){var f=l.substring(0,p-1),m=l.substring(p);this.strings[a]=f+t(i)+m}var d=h[1],g=h[2],v=this.strings[a].length-g.length;this.strings[a]=this.strings[a].slice(0,v);for(var y="",b=this.strings[a+1],x=r.exec(b);null===x;)y+=b+e[a+1],this.strings.splice(a+1,1),e.splice(a+1,1),o--,b=this.strings[a+1],x=r.exec(b);var N=x[1];this.strings[a+1]=b.slice(N.length);var T=g+u+y+N;this.slots.push(new s(i,T,d))}else i++,this.strings[a]=l+t(i),this.slots.push(new s(i,u))}},i}(),l=function(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];return new a(t.raw.slice(0),e)},u=function(t,e){return new o(t,e).render()};export{a as Template,l as html,u as render};
